<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í˜ë¡œì˜ ìŠ¤ë§ˆíŠ¸í°</title> <!-- [v6.12] íƒ€ì´í‹€ ìˆ˜ì • -->

    <!-- (í”„ë¦¬ë¡œë“œ ë§í¬ ... v6.7ê³¼ ë™ì¼) -->
    <!-- [v5.4] ì´ë¯¸ì§€ í”„ë¦¬ë¡œë”© --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/5c2d38cc-5339-420c-ac05-ee6d1034312c.jpeg"> <!-- curious (default) --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/1b5eefa5-d595-4ec6-83d8-95d4dda199e1.jpeg"> <!-- smile --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/3b49664e-46ec-49c1-8972-ce6e9d76ffb8.jpeg"> <!-- happy --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/c6f70f02-424a-4617-8592-b075e4cc4aa3.jpeg"> <!-- fearful --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/6bdf27e1-85e8-4950-8065-5d9119974f3e.jpeg"> <!-- angry --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/7e32d9a5-b495-473b-9483-55cf632c0694.jpeg"> <!-- serious --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/b7cced60-0c2e-4676-87d4-23ee2eaf2fab.jpeg"> <!-- shy --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/f1221102-c991-4935-a333-55b8456abd43.jpeg"> <!-- sleepy --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/383df272-35f8-454d-8c47-fcefe0f59f3e.jpeg"> <!-- embarrased --><!-- [v6.3] ìƒˆ ê°¤ëŸ¬ë¦¬ ì´ë¯¸ì§€ í”„ë¦¬ë¡œë”© --><link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/4ebb1d35-3d23-4847-88ca-da4cea8dbe7c.jpeg">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/06928558-39bf-4f97-82dc-ef253251946f.png">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/70b6d548-c512-4130-bdb6-a702740f1668.png">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/23bc73e5-8b23-4acf-b7b5-be0be8784c57.png">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/e61c85ae-b502-40bc-b2c6-45858eeef0db.png">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/30a93d41-851b-411c-967f-a68075a5e7a1.jpeg">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/680467da-a19c-4dff-a01d-c7b54bc52c4e.jpeg">
    <link rel="preload" as="image" href="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/3fe4dfe7-544a-410e-a078-b452c68272c2.jpeg">


    <style>
        /* [v6.14] var(--vh) ì‚¬ìš©ì„ ìœ„í•œ ê¸°ë³¸ ì„¤ì • */
        *, *::before, *::after { box-sizing: border-box; }
        /* [v6.14] height: 100vh ëŒ€ì‹  var(--vh) ì‚¬ìš© */
        body { font-family: 'Gulim', 'Dotum', sans-serif; background-color: #111; color: #eee; display: flex; justify-content: center; align-items: center; height: 100vh; height: calc(var(--vh, 1vh) * 100); margin: 0; overflow: hidden; }
        /* [v6.12] aspect-ratio ì œê±° */
        /* [v6.14] height: 100vh ëŒ€ì‹  var(--vh) ì‚¬ìš© */
        #game-wrapper { width: 100%; height: 100vh; height: calc(var(--vh, 1vh) * 100); max-width: 450px; background-color: #0a0a2a; border: 2px solid #a0a0e0; border-radius: 20px; box-shadow: 0 0 20px rgba(150, 150, 255, 0.3); position: relative; overflow: hidden; display: flex; flex-direction: column; }
        #phone-hud { width: 100%; height: 25px; background-color: #1a1a3a; border-bottom: 1px solid #3a3a5a; padding: 0 15px; display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #a0a0e0; flex-shrink: 0; }
        #pherro-view { aspect-ratio: 1344 / 768; width: 100%; background: #1a1a3a url('https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/5c2d38cc-5339-420c-ac05-ee6d1034312c.jpeg') no-repeat center center; background-size: contain; padding: 8px; flex-shrink: 0; border-bottom: 1px solid #3a3a5a; transition: background-image 0.3s ease-in-out; }
        #pherro-bubble-container { height: 80px; padding: 10px; display: flex; align-items: center; justify-content: flex-start; flex-shrink: 0; border-bottom: 2px solid #3a3a5a; background-color: #1a1a3a; }
        .pherro-bubble { background-color: #3a3a5a; padding: 12px; border-radius: 10px; font-size: 14px; max-width: 90%; word-wrap: break-word; }
        #main-screen { position: relative; flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; }
        
        #homescreen { flex-grow: 1; padding: 20px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; background-color: #0a0a2a; overflow-y: auto; justify-items: center; align-content: start; }
        .icon { text-align: center; cursor: pointer; color: white; font-size: 12px; z-index: 5; position: relative; width: 60px; }
        .icon img { width: 50px; height: 50px; border-radius: 10px; border: 1px solid #555; margin-bottom: 5px; }
        .icon span { display: block; background-color: rgba(0, 0, 0, 0.5); padding: 2px 0; border-radius: 3px; word-break: break-word; }
        
        .app-screen { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #1a1a3a; flex-direction: column; z-index: 200; }
        .app-header { background-color: #3a3a5a; padding: 8px 15px; display: flex; align-items: center; font-size: 16px; flex-shrink: 0; }
        .app-back-button { cursor: pointer; font-weight: bold; font-size: 20px; margin-right: 15px; line-height: 1; }
        .app-content { padding: 15px; flex-grow: 1; overflow-y: auto; }
        .app-content img { width: 100%; height: auto; display: block; aspect-ratio: 1 / 1; object-fit: cover; border-radius: 5px; }
        .app-content-nopadding { flex-grow: 1; overflow-y: auto; overflow-x: hidden; }
        .app-list { list-style: none; padding: 0; margin: 0; }
        .app-list-item { display: flex; align-items: center; padding: 15px; border-bottom: 1px solid #3a3a5a; font-size: 16px; cursor: pointer; }
        .app-list-item:hover { background-color: #3a3a5a; }
        .app-list-item img { width: 40px; height: 40px; border-radius: 5px; margin-right: 15px; }
        #gallery-list-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; padding: 5px; }
        .gallery-item { width: 100%; aspect-ratio: 1 / 1; background-color: #2a2a4a; cursor: pointer; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; }
        .chat-bubble { padding: 10px 15px; border-radius: 15px; margin-bottom: 10px; max-width: 80%; clear: both; }
        .chat-bubble.lapin { background-color: #2a2a4a; float: left; }
        .chat-bubble.pherro { background-color: #a0a0e0; color: #111; float: right; }
        .image-memo { background-color: #2a2a4a; border: 1px dashed #5a5a7a; padding: 10px; margin-top: 15px; border-radius: 5px; font-size: 14px; color: #ccc; line-height: 1.6; }
        .image-memo strong { color: #a0a0e0; display: block; margin-bottom: 5px; }

        /* [v6.10] 'ì‘ì „ì‹œì‘' ì•± ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        .intro-text { font-size: 16px; line-height: 1.6; color: #ddd; background-color: #2a2a4a; padding: 15px; border-radius: 5px; }
        .link-button { display: block; background-color: #a0a0e0; color: #111; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; text-align: center; margin-top: 30px; }
        .link-button:hover { background-color: #c0c0ff; }
    </style>
</head>
<body>

    <div id="game-wrapper">
        <div id="phone-hud">
            <span>13:30</span>
            <span>ğŸ”‹ 85%</span>
        </div>
        <div id="pherro-view"></div>
        <div id="pherro-bubble-container"></div>
        <div id="main-screen"> 
            <div id="homescreen">
                <div class="icon" id="icon-memo"><img src="https://placehold.co/50x50/f0f0f0/000000?text=MEMO" alt="Memo app"><span>ë©”ëª¨ì¥</span></div>
                <div class="icon" id="icon-gallery"><img src="https://placehold.co/50x50/a0a0ff/ffffff?text=GALLERY" alt="Gallery app"><span>ê°¤ëŸ¬ë¦¬</span></div>
                <div class="icon" id="icon-messenger"><img src="https://placehold.co/50x50/ffff44/000000?text=TALK" alt="Messenger app"><span>ë©”ì‹ ì €</span></div>
                <!-- [v6.10] 'ì‘ì „ì‹œì‘' ì•„ì´ì½˜ ì¶”ê°€ -->
                <div class="icon" id="icon-start-op"><img src="https://placehold.co/50x50/ff4444/ffffff?text=GO!" alt="Start Op app"><span>ì‘ì „ì‹œì‘</span></div>
            </div>

            <!-- 1. ë©”ëª¨ì¥ ì•± (v6.9ì™€ ë™ì¼) --><div class="app-screen" id="app-memo">
                <div class="app-header"><span class="app-back-button" id="close-memo">&lt;</span><span>ë©”ëª¨ì¥</span></div>
                <div class="app-content-nopadding">
                    <ul class="app-list">
                        <li class="app-list-item" id="memo-item-failure"><img src="https://placehold.co/40x40/f0f0f0/000?text=T" alt="txt">ì‹¤íŒ¨_ë³´ê³ ì„œ.txt</li>
                        <li class="app-list-item" id="memo-item-mystery"><img src="https://placehold.co/40x40/f0f0f0/000?text=T" alt="txt">3ëŒ€_ë¯¸ìŠ¤í„°ë¦¬.txt</li>
                        <li class="app-list-item" id="memo-item-vault"><img src="https://placehold.co/40x40/f0f0f0/000?text=T" alt="txt">7ì¸µ_ê¸ˆê³ _ë¹„ë²ˆ(ì¶”ì •).txt</li>
                        <li class="app-list-item" id="memo-item-diary"><img src="https://placehold.co/40x40/ffc0cb/000?text=D" alt="diary">ë¹„ë°€ ì¼ê¸°ì¥ (ì ê¸ˆ)</li>
                    </ul>
                </div>
            </div>
            <div class="app-screen" id="app-memo-content">
                <div class="app-header"><span class="app-back-button" id="close-memo-content">&lt;</span><span id="memo-content-title"></span></div>
                <div class="app-content" id="memo-content-body"></div>
            </div>

            <!-- 2. ê°¤ëŸ¬ë¦¬ ì•± (v6.7ê³¼ ë™ì¼) --><div class="app-screen" id="app-gallery">
                <div class="app-header"><span class="app-back-button" id="close-gallery">&lt;</span><span>ê°¤ëŸ¬ë¦¬</span></div>
                <div class="app-content-nopadding">
                    <div id="gallery-list-container">
                        <div class="gallery-item" id="gallery-item-onsen"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/4ebb1d35-3d23-4847-88ca-da4cea8dbe7c.jpeg" alt="onsen"></div>
                        <div class="gallery-item" id="gallery-item-mirage"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/06928558-39bf-4f97-82dc-ef253251946f.png" alt="mirage"></div>
                        <div class="gallery-item" id="gallery-item-academy-shy"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/70b6d548-c512-4130-bdb6-a702740f1668.png" alt="academy shy"></div>
                        <div class="gallery-item" id="gallery-item-academy-confident"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/23bc73e5-8b23-4acf-b7b5-be0be8784c57.png" alt="academy confident"></div>
                        <div class="gallery-item" id="gallery-item-fennec"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/e61c85ae-b502-40bc-b2c6-45858eeef0db.png" alt="fennec"></div>
                        <div class="gallery-item" id="gallery-item-sexy"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/30a93d41-851b-411c-967f-a68075a5e7a1.jpeg" alt="sexy"></div>
                        <div class="gallery-item" id="gallery-item-lapin-fishing"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/680467da-a19c-4dff-a01d-c7b54bc52c4e.jpeg" alt="lapin fishing"></div>
                        <div class="gallery-item" id="gallery-item-mirage-selca"><img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/3fe4dfe7-544a-410e-a078-b452c68272c2.jpeg" alt="mirage selca"></div>
                    </div>
                </div>
            </div>
            <div class="app-screen" id="app-gallery-detail">
                <div class="app-header"><span class="app-back-button" id="close-gallery-detail">&lt;</span><span id="gallery-detail-title"></span></div>
                <div class="app-content" id="gallery-detail-content">
                    <!-- JSê°€ ì—¬ê¸°ì— imgì™€ memo divë¥¼ ìƒì„± --></div>
            </div>

            <!-- 3. ë©”ì‹ ì € ì•± (v6.8ê³¼ ë™ì¼) --><div class="app-screen" id="app-messenger">
                <div class="app-header"><span class="app-back-button" id="close-messenger">&lt;</span><span>ë©”ì‹ ì €</span></div>
                <div class="app-content-nopadding">
                    <ul class="app-list">
                        <li class="app-list-item" id="messenger-item-lapin">
                            <img src="https://placehold.co/40x40/a0e0a0/000?text=R" alt="Lapin">
                            <div><b>ì •ë³´ì›_ë¼í•€</b><p style="font-size: 12px; color: #999; margin: 0;">í˜ë¡œ: ì´ ë„ˆêµ¬ë¦¬ê°€!!</p></div>
                        </li>
                        <li class="app-list-item" id="messenger-item-team">
                            <img src="https://placehold.co/40x40/1e3a8a/fff?text=P" alt="Team">
                            <div><b>ë¯¸ë¼ì¥¬ ì²´í¬ ì‘ì „ë°˜ (3)</b><p style="font-size: 12px; color: #999; margin: 0;">í˜ë¡œ: 2íŒ€!! ëŒ€ë‹µ ì•ˆ í•´?!?</p></div>
                        </li>
                        <li class="app-list-item" id="messenger-item-mirage">
                            <img src="https://placehold.co/40x40/ff0000/fff?text=?" alt="Unknown">
                            <div><b>???</b><p style="font-size: 12px; color: #ff8888; margin: 0;">(ì½ì§€ ì•Šì€ ë©”ì‹œì§€: 1)</p></div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="app-screen" id="app-messenger-chat">
                <div class="app-header"><span class="app-back-button" id="close-messenger-chat">&lt;</span><span id="messenger-chat-title"></span></div>
                <div class="app-content" id="messenger-chat-content">
                    <!-- JSê°€ ì—¬ê¸°ì— chat-bubble divë“¤ì„ ìƒì„± --></div>
            </div>

            <!-- [v6.10] 'ì‘ì „ì‹œì‘' ì•± í™”ë©´ ì¶”ê°€ --><div class="app-screen" id="app-start-op">
                <div class="app-header"><span class="app-back-button" id="close-start-op">&lt;</span><span>ì‘ì „ì‹œì‘</span></div>
                <div class="app-content">
                    <div class="intro-text">
                        ë„ì‹œë¥¼ ë’¤í”ë“œëŠ” ê´´ë„ ë¯¸ë¼ì¥¬, ê·¸ë…€ë¥¼ ì«“ëŠ” ê²½ì°° ëŒ€ì¥ í˜ë¡œ.
                        <br><br>
                        3ì¼ ì•ˆì— ë¯¸ë¼ì¥¬ë¥¼ ì²´í¬í•˜ì§€ ëª»í•˜ë©´, ë„ì‹œëŠ” ì˜ì›í•œ ë°¤ì— ì ê¸´ë‹¤!
                    </div>
                    <a href="https://share.crack.wrtn.ai/v4gsa7" target="_blank" class="link-button">
                        ìŠ¤í† ë¦¬ì±— í•˜ëŸ¬ ê°€ê¸°
                    </a>
                </div>
            </div>

        </div>
    </div>

    <script>
        // [v6.14] ëª¨ë°”ì¼ ë†’ì´ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì´ˆê¸°í™” í•¨ìˆ˜
        const setDocHeight = () => {
            document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
        };
        // [v6.14] ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ì— ì—°ê²°
        window.addEventListener('resize', setDocHeight);
        // [v6.16] DOM ë¡œë“œì™€ ê´€ê³„ì—†ì´ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ì¦‰ì‹œ í˜¸ì¶œ
        setDocHeight();
        
        // --- [v5.0] í˜ë¡œ ìŠ¤í”„ë¼ì´íŠ¸ DB ---
        const pherroSprites = {
            'default': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/5c2d38cc-5339-420c-ac05-ee6d1034312c.jpeg', // curious
            'smile': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/1b5eefa5-d595-4ec6-83d8-95d4dda199e1.jpeg',
            'happy': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/3b49664e-46ec-49c1-8972-ce6e9d76ffb8.jpeg',
            'fearful': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/c6f70f02-424a-4617-8592-b075e4cc4aa3.jpeg',
            'angry': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/6bdf27e1-85e8-4950-8065-5d9119974f3e.jpeg',
            'serious': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/7e32d9a5-b495-473b-9483-55cf632c0694.jpeg',
            'shy': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/b7cced60-0c2e-4676-87d4-23ee2eaf2fab.jpeg',
            'sleepy': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/f1221102-c991-4935-a333-55b8456abd43.jpeg',
            'embarrased': 'https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/383df272-35f8-454d-8c47-fcefe0f59f3e.jpeg'
        };

        // --- [v6.11] í˜ë¡œ ë°˜ì‘ DB ìˆ˜ì • ---
        const pherroReactions = {
            'trigger_first_visit': { text: "Zzz... ìœ¼... ë‚´ í°... ì™œ ì¼œì¡Œì§€...", emotion: "sleepy" },
            'trigger_return_home': { text: "í™ˆ í™”ë©´ì€ ì´ì œ ê·¸ë§Œ ë´ë„ ë˜ëŠ”ë°...", emotion: "curious" },
            'trigger_memo_open': { text: "ì–´? ë©”ëª¨ì¥? ê±°ê¸°ì—” ë³„ê±° ì—†ì„ í…ë°...", emotion: "sleepy" },
            'trigger_failure': { text: "ì•„ì•…!! ê·¸ê±´ ì™œ ì—´ì–´ë´! ì§€, ì§€ì› ëŠ”ë° ì™œ ì•„ì§ ìˆì–´! ë‹¹ì¥ ë‹«ì•„!!", emotion: "embarrased" },
            'trigger_mystery_file': { text: "ì‘? ê·¸ íŒŒì¼ì€ ë­ì•¼? ...ì½”ë„¬ í˜•ì‚¬? ë‚œ ëª¨ë¥´ëŠ” ì´ë¦„ì¸ë°?", emotion: "curious" },
            'trigger_vault_note': { text: "ì´, ì´ê±´ ì™œ ë´! ...ë‚´ê°€ ê¹Œë¨¹ì„ê¹Œ ë´ ì ì–´ë‘” ê²ƒë¿ì´ì•¼!", emotion: "shy" },
            'trigger_gallery_open': { text: "ê°¤ëŸ¬ë¦¬? ì™œ...!? ì €, ì € ì‚¬ì§„ì€!", emotion: "curious" },
            'trigger_messenger_open': { text: "í¥. ê·¸ ë„ˆêµ¬ë¦¬... ë‘ì€ ë¬´ìŠ¨ í•  ë§ì´ ìˆë‹¤ê³ .", emotion: "serious" },
            'trigger_lapin_chat': { text: "ì¹«, ì € ë„ˆêµ¬ë¦¬... ë§¨ë‚  ê·€ì°®ëŒ€.", emotion: "angry" },
            'trigger_team_chat': { text: "ë‹¤ë“¤ ê¸´ì¥ê°ì´ ë¶€ì¡±í•´! ë‚˜ë§Œ ë°”ì˜ì§€!", emotion: "angry" },
            'trigger_mirage_chat': { text: "ë­, ë­ì•¼! ì´ ë°œì‹ ì ë¶ˆëª…ì€...!! ...ì„¤ë§ˆ... ì € ê´´ëƒ¥ì´ ì•„ë‹ˆì•¼?!", emotion: "angry" },
            'trigger_diary': { text: "ì´, ì´ê±´...!! ë„Œ, ë„Œ ì´ê±¸ ì–´ë–»ê²Œ ì—° ê±°ì•¼! ë³´ì§€ ë§ˆ!! ë‹¹ì¥ ë®ì–´!!!", emotion: "embarrased" },

            'trigger_gallery_onsen': { text: "ì´, ì´ê±´...! ìœ¼... ëˆ„ê°€ ì°ì€ ê±°ì•¼?! ë³´, ë³´ë©´ ì•ˆë¼!", emotion: "embarrased" }, // [v6.11] ìˆ˜ì •
            'trigger_gallery_mirage': { text: "ë˜ ë†“ì³¤ì„ ë•Œ ì‚¬ì§„ì´ì–ì•„! ...ë‹¤ìŒì—” ë°˜ë“œì‹œ, ë°˜ë“œì‹œ ì¡ê³  ë§ ê±°ì•¼!", emotion: "angry" }, // [v6.11] ìˆ˜ì •
            'trigger_gallery_academy_shy': { text: "ì•„...!! ì´ê±´ ì•„ì¹´ë°ë¯¸ ì‹œì ˆì´ì–ì•„! ìœ¼... ì´ëŸ° ê±¸ ì™œ ë³´ê³  ìˆì–´!", emotion: "shy" }, // [v6.11] ìˆ˜ì •
            'trigger_gallery_academy_confident': { text: "í ! ì—­ì‹œ ë‚œ ë©‹ì ¸! ...ì´ë•Œë¶€í„° ëŒ€ì¥ì˜ í’ëª¨ê°€ ìˆì—ˆì§€.", emotion: "happy" },
            'trigger_gallery_fennec': { text: "í˜ë„¥ í•™ìƒíšŒì¥... ê·¸ë•Œë‚˜ ì§€ê¸ˆì´ë‚˜ ì—¬ì „íˆ ë©‹ìˆë„¤. ...ë­! ë­˜ ë³´ëŠ” ê±°ì•¼! ë‚¨ì˜ ê°¤ëŸ¬ë¦¬ë¥¼!", emotion: "smile" }, // [v6.11] ìˆ˜ì • -> [v6.12] ìˆ˜ì •
            'trigger_gallery_sexy': { text: "ë­, ë­ì•¼!! ì´, ì´ê±´ ì ê°€ ë†¨ëŠ”ë°! ë³´ì§€ ë§ˆ! ë³´ì§€ ë§ë¼ê³ !!", emotion: "fearful" },
            'trigger_gallery_lapin_fishing': { text: "í•˜... ë˜ ì € ë„ˆêµ¬ë¦¬... ì €ê±¸ ì™œ ë‚˜í•œí…Œ ë³´ë‚¸ ê±°ì§€?", emotion: "serious" },
            'trigger_gallery_mirage_selca': { text: "íˆìµ?!? ì´, ì´ ì‚¬ì§„ì´ ì™œ ë˜ ì—¬ê¹„ì–´! ì§€ì› ëŠ”ë°! ì§€ì› ë‹¤ê³ !! ì €, ì € ê´´ëƒ¥ì´ê°€...!!!", emotion: "fearful" },

            'trigger_start_op': { text: "ì¢‹ì•„! ë“œë””ì–´ ì‘ì „ì„ ì‹œì‘í•˜ëŠ” ê±°ì§€?! ì´ë²ˆì—” ì € ê´´ëƒ¥ì´... ê¼­ ì¡ëŠ” ê±°ì•¼!", emotion: "happy" }
        };
        
        // --- ì „ì—­ ë³€ìˆ˜ ë° ê³µí†µ í•¨ìˆ˜ (v6.2ì™€ ë™ì¼) ---
        const chatBox = document.getElementById('pherro-bubble-container');
        const homescreen = document.getElementById('homescreen');
        const pherroView = document.getElementById('pherro-view');
        let isFirstVisit = true;
        // [v6.15] í˜„ì¬ ì•±ì˜ IDë¥¼ ì €ì¥í•  ìŠ¤íƒ
        const appStack = []; 

        function changePherroSprite(emotion) {
            const imageUrl = pherroSprites[emotion] || pherroSprites['default'];
            pherroView.style.backgroundImage = `url('${imageUrl}')`;
        }

        function pherroReacts(triggerKey) {
            const reaction = pherroReactions[triggerKey];
            if (!reaction) return;
            changePherroSprite(reaction.emotion);
            chatBox.innerHTML = ''; 
            const newBubble = document.createElement('div');
            newBubble.classList.add('pherro-bubble');
            newBubble.innerText = "í˜ë¡œ| " + reaction.text;
            chatBox.appendChild(newBubble);
        }

        function openApp(appElement, reactionKey) {
            // [v6.15] ì•±ì„ ì—´ ë•Œ íˆìŠ¤í† ë¦¬ ìƒíƒœ ê¸°ë¡ ë° ìŠ¤íƒì— ì¶”ê°€
            const appID = appElement.id;
            
            // í˜„ì¬ í™”ë©´ì´ í™ˆìŠ¤í¬ë¦°ì´ ì•„ë‹ˆë¼ë©´, í˜„ì¬ ìƒíƒœë¥¼ ìŠ¤íƒì— ê¸°ë¡
            if (appID !== 'homescreen' && homescreen.style.display !== 'grid') {
                appStack.push(appID);
                history.pushState({ app: appID }, '', `#${appID}`);
            } else if (appID !== 'homescreen') {
                appStack.push(appID);
                history.pushState({ app: appID }, '', `#${appID}`);
            }

            homescreen.style.display = 'none';
            appElement.style.display = 'flex';
            if (reactionKey) { 
                pherroReacts(reactionKey);
            }
        }

        function closeApp(appElement) {
            // [v6.15] ì•±ì„ ë‹«ì„ ë•Œ ìŠ¤íƒì—ì„œ ì œê±° (í•˜ë“œì›¨ì–´ ë’¤ë¡œê°€ê¸°ëŠ” popstateì—ì„œ ì²˜ë¦¬)
            appElement.style.display = 'none';

            // [v6.15] í™ˆìŠ¤í¬ë¦°ìœ¼ë¡œ ëŒì•„ê°ˆ ë•Œë§Œ gridë¡œ ì„¤ì •
            if (appElement.id === 'app-memo' || appElement.id === 'app-gallery' || appElement.id === 'app-messenger' || appElement.id === 'app-start-op') {
                 homescreen.style.display = 'grid';
                 appStack.splice(0, appStack.length); // í™ˆìœ¼ë¡œ ëŒì•„ê°€ë©´ ìŠ¤íƒ ì´ˆê¸°í™”
                 history.pushState({ app: 'homescreen' }, '', '#homescreen'); // í™ˆìŠ¤í¬ë¦° ìƒíƒœ ê¸°ë¡
            } else if (appElement.id === 'app-memo-content') {
                 document.getElementById('app-memo').style.display = 'flex';
                 appStack.pop();
            } else if (appElement.id === 'app-gallery-detail') {
                 document.getElementById('app-gallery').style.display = 'flex';
                 appStack.pop();
            } else if (appElement.id === 'app-messenger-chat') {
                 document.getElementById('app-messenger').style.display = 'flex';
                 appStack.pop();
            }
            
            pherroReacts('trigger_return_home'); 
        }
        
        // --- [v6.15] ëª¨ë°”ì¼ 'ë’¤ë¡œê°€ê¸°' (popstate) ì´ë²¤íŠ¸ ì²˜ë¦¬ ---
        window.onpopstate = function(event) {
            // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°ê°€ ëˆŒë ¸ì„ ë•Œ ì‹¤í–‰ë¨
            if (appStack.length > 0) {
                // ìŠ¤íƒì˜ ë§ˆì§€ë§‰ ìš”ì†Œë¥¼ ì œê±°í•˜ê³  (í˜„ì¬ ë‹«í í™”ë©´)
                appStack.pop();
                
                // ìŠ¤íƒì— ë‚¨ì€ ë§ˆì§€ë§‰ ìš”ì†Œë¥¼ í™•ì¸ (ëŒì•„ê°€ì•¼ í•  í™”ë©´)
                const targetAppId = appStack.length > 0 ? appStack[appStack.length - 1] : 'homescreen';
                
                // ëª¨ë“  ì•±ì„ ìˆ¨ê¹€
                document.querySelectorAll('.app-screen').forEach(app => app.style.display = 'none');

                if (targetAppId === 'homescreen') {
                    homescreen.style.display = 'grid';
                    pherroReacts('trigger_return_home');
                } else {
                    document.getElementById(targetAppId).style.display = 'flex';
                    // ì´ ë•ŒëŠ” ë°˜ì‘ì„ ê±´ë„ˆëœ€ (ì•± ë‚´ë¶€ì—ì„œ ì´ë¯¸ ë°˜ì‘ì„ ë³´ì˜€ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ)
                }
            } else {
                // ìŠ¤íƒì´ ë¹„ì–´ìˆìœ¼ë©´ (ì•±ì´ ë‹«íˆê³  í™ˆìŠ¤í¬ë¦°ì— ìˆì„ ë•Œ)
                // ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ë’¤ë¡œê°€ê¸° ë™ì‘ì„ ìˆ˜í–‰í•˜ì—¬ ì´ì „ ì›¹í˜ì´ì§€ë¡œ ëŒì•„ê°€ë„ë¡ í—ˆìš©
                // í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” í˜„ì¬ í˜ì´ì§€ê°€ ì²« ì§„ì…ì ì´ë¼ ì•„ë¬´ê²ƒë„ ì•ˆ í•¨.
            }
        };

        
        document.addEventListener('DOMContentLoaded', () => {
            
            // [v6.15] ì´ˆê¸° ì§„ì… ì‹œ homescreen ìƒíƒœ ê¸°ë¡
            history.replaceState({ app: 'homescreen' }, '', '#homescreen');

            // --- [v6.2] ë²„ê·¸ ìˆ˜ì •ëœ í´ë¦­ ë¡œì§ ìœ ì§€ ---

            // --- 1. ë©”ëª¨ì¥ ì•± ë¡œì§ (v6.9ì™€ ë™ì¼) ---
            const iconMemo = document.getElementById('icon-memo'); 
            const appMemo = document.getElementById('app-memo');
            const closeMemo = document.getElementById('close-memo');
            const appMemoContent = document.getElementById('app-memo-content');
            const closeMemoContent = document.getElementById('close-memo-content');
            const memoContentTitle = document.getElementById('memo-content-title');
            const memoContentBody = document.getElementById('memo-content-body');
            const memoItemFailure = document.getElementById('memo-item-failure');
            const memoItemMystery = document.getElementById('memo-item-mystery');
            const memoItemVault = document.getElementById('memo-item-vault'); 
            const memoItemDiary = document.getElementById('memo-item-diary');

            iconMemo.addEventListener('click', (e) => { 
                e.stopPropagation(); 
                openApp(appMemo, 'trigger_memo_open');
            });
            closeMemo.addEventListener('click', () => {
                closeApp(appMemo);
                history.back(); // [v6.15] history.back() í˜¸ì¶œë¡œ onpopstateë¥¼ íŠ¸ë¦¬ê±°
            });

            closeMemoContent.addEventListener('click', () => {
                // closeApp(appMemoContent); // [v6.15] ì§ì ‘ ë‹«ì§€ ì•Šê³  history.back() í˜¸ì¶œ
                history.back();
            });

            memoItemFailure.addEventListener('click', () => {
                appMemo.style.display = 'none';
                openApp(appMemoContent, 'trigger_failure'); // [v6.15] openApp ì‚¬ìš©
                memoContentTitle.innerText = "ì‹¤íŒ¨_ë³´ê³ ì„œ.txt";
                memoContentBody.innerHTML = `
                    <p><b>ì‘ì „ëª…:</b> ì´ˆê°•ë ¥ ê°•ì•„ì§€ ëŒê²© ì‘ì „</p>
                    <p><b>ê²°ê³¼:</b> ì‹¤íŒ¨.</p>
                    <p><b>ì‚¬ìœ :</b> ê´´ë„ ë¯¸ë¼ì¥¬ê°€... ë„ˆë¬´ ë¹¨ëìŒ.</p>
                    <p>...</p><p>...</p><p>...</p>
                    <p>ì •ë§ ì™œ ì•ˆì§€ì›Œì§€ëŠ” ê±°ì§€?</p>`;
            });

            memoItemMystery.addEventListener('click', () => {
                appMemo.style.display = 'none';
                openApp(appMemoContent, 'trigger_mystery_file');
                memoContentTitle.innerText = "3ëŒ€_ë¯¸ìŠ¤í„°ë¦¬.txt";
                memoContentBody.innerHTML = `
                    <p><b>[ê²½ì°°ì„œ 3ëŒ€ ë¯¸ìŠ¤í„°ë¦¬]</b></p><br>
                    <p>1. ê²½ì°° ëŒ€ì¥ì˜ ë¹„ë°€</p>
                    <p>2. 7ì¸µì˜ ê¸ˆê³ </p>
                    <p>3. ì½”ë„¬ í˜•ì‚¬</p><br>
                    <p>...ë” ì½ìœ¼ë ¤ê³ ?</p>`;
            });

            memoItemVault.addEventListener('click', () => {
                appMemo.style.display = 'none';
                openApp(appMemoContent, 'trigger_vault_note');
                memoContentTitle.innerText = "7ì¸µ_ê¸ˆê³ _ë¹„ë²ˆ(ì¶”ì •).txt";
                memoContentBody.innerHTML = `
                    <p><b>[ì ˆëŒ€ ê¹Œë¨¹ì§€ ë§ ê²ƒ!]</b></p><br>
                    <p>1. 1234 (ì•„ë‹˜)</p>
                    <p>2. 0000 (ì•„ë‹˜)</p>
                    <p>3. 1111 (ì•„ë‹˜)</p>
                    <p>4. ë‚´ ìƒì¼ (ì•„ë‹˜)</p>
                    <p>5. DogBiscuit (ì•„ë‹˜!!)</p><br>
                    <p>...ëŒ€ì²´ ë­ì•¼?!?</p>`;
            });

            memoItemDiary.addEventListener('click', () => {
                appMemo.style.display = 'none';
                openApp(appMemoContent, 'trigger_diary');
                memoContentTitle.innerText = "ë¹„ë°€ ì¼ê¸°ì¥ (ì ê¸ˆ)";
                memoContentBody.innerHTML = `
                    <p><b>[Xì›” Xì¼]</b></p><br>
                    <p>ì •ë§... 'ê·¸ ë…€ì„'ì€ ë°”ë³´ì•¼. ë§¨ë‚  ë‚´ ëª…ë ¹ë„ ì œëŒ€ë¡œ ëª» ë“£ê³ !</p>
                    <p>...ê·¸ë˜ë„...</p>
                    <p>ì´ìƒí•˜ê²Œ ê·¸ ë…€ì„ì´ ì˜†ì— ìˆìœ¼ë©´, ì¡°ê¸ˆ... ì•„ì£¼ ì¡°ê¸ˆì€ ë“ ë“ í•œ ê²ƒ ê°™ê¸°ë„ í•˜ê³ .</p>
                    <p>...ì¹«! ë‚´ê°€ ì™œ ì´ëŸ° ìƒê°ì„ í•˜ëŠ” ê±°ì•¼!</p>
                    <p>(...ê³ ë§™ë‹¤ê³ ëŠ”, ì ˆëŒ€ ë§ ì•ˆ í•´ì¤„ ê±°ì§€ë§Œ.)</p>`;
            });

            // --- 2. ê°¤ëŸ¬ë¦¬ ì•± ë¡œì§ (v6.7ê³¼ ë™ì¼) ---
            const iconGallery = document.getElementById('icon-gallery'); 
            const appGallery = document.getElementById('app-gallery');
            const closeGallery = document.getElementById('close-gallery');
            const appGalleryDetail = document.getElementById('app-gallery-detail');
            const closeGalleryDetail = document.getElementById('close-gallery-detail');
            const galleryDetailTitle = document.getElementById('gallery-detail-title'); 
            const galleryDetailContent = document.getElementById('gallery-detail-content'); 
            
            const galleryItemOnsen = document.getElementById('gallery-item-onsen');
            const galleryItemMirage = document.getElementById('gallery-item-mirage');
            const galleryItemAcademyShy = document.getElementById('gallery-item-academy-shy');
            const galleryItemAcademyConfident = document.getElementById('gallery-item-academy-confident');
            const galleryItemFennec = document.getElementById('gallery-item-fennec');
            const galleryItemSexy = document.getElementById('gallery-item-sexy');
            const galleryItemLapinFishing = document.getElementById('gallery-item-lapin-fishing');
            const galleryItemMirageSelca = document.getElementById('gallery-item-mirage-selca');
            
            iconGallery.addEventListener('click', (e) => { 
                e.stopPropagation(); 
                openApp(appGallery, 'trigger_gallery_open');
            });
            closeGallery.addEventListener('click', () => {
                closeApp(appGallery);
                history.back(); // [v6.15] history.back() í˜¸ì¶œë¡œ onpopstateë¥¼ íŠ¸ë¦¬ê±°
            });

            closeGalleryDetail.addEventListener('click', () => {
                history.back();
            });

            galleryItemOnsen.addEventListener('click', () => {
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_onsen');
                galleryDetailTitle.innerText = "Zzz...";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/4ebb1d35-3d23-4847-88ca-da4cea8dbe7c.jpeg" alt="ì˜¨ì²œ ì‚¬ì§„">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ì´ê²Œ ì–¸ì œ ì°í˜”ì§€? ë¶„ëª…íˆ ì˜¨ì²œì—ì„  ì•„ë¬´ë„...<br>
                        ...ì ê¹, ê·¸ëŸ¼ ì´ê±¸ ë„¤ê°€?!
                    </div>`;
            });

            galleryItemMirage.addEventListener('click', () => {
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_mirage');
                galleryDetailTitle.innerText = "ë¯¸ë¼ì¥¬ ë„ì£¼ ì‚¬ì§„";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/06928558-39bf-4f97-82dc-ef253251946f.png" alt="ë¯¸ë¼ì¥¬ ë„ì£¼">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ì´ë•Œ... ë¶„ëª…íˆ ë‹¤ ì¡ì•˜ëŠ”ë°!<br>
                        ì € ê´´ëƒ¥ì´, ë‹¤ìŒì—” ê¼­ ì¡ëŠ”ë‹¤! (ì¦ê±°ìë£Œ 1)
                    </div>`;
            });
            
            galleryItemAcademyShy.addEventListener('click', () => { // [v6.11] ë©”ëª¨ ìˆ˜ì •
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_academy_shy');
                galleryDetailTitle.innerText = "ì•„ì¹´ë°ë¯¸ ì‹œì ˆ";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/70b6d548-c512-4130-bdb6-a702740f1668.png" alt="ì•„ì¹´ë°ë¯¸ ì†Œì‹¬">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ...ì´ëŸ° ì‹œì ˆ ì—†ì—ˆì–´! ì—†ì—ˆë‹¤ê³ !<br>
                        (ì´ ì‚¬ì§„... ë¶€ë„ëŸ¬ìš°ë‹ˆê¹Œ ìˆ¨ê²¨ë†”ì•¼ì§€.)
                    </div>`;
            });

            galleryItemAcademyConfident.addEventListener('click', () => {
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_academy_confident');
                galleryDetailTitle.innerText = "ëŒ€ì¥ ìœ„ì—„ìƒ·"; 
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/23bc73e5-8b23-4acf-b7b5-be0be8784c57.png" alt="ì•„ì¹´ë°ë¯¸ ë‹¹ë‹¹">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        í ! ì—­ì‹œ ë‚œ ë©‹ì ¸!<br>
                        ëŒ€ì¥ì˜ í’ëª¨ê°€ ëŠê»´ì§€ì§€ ì•Šì•„?!
                    </div>`;
            });
            
            galleryItemFennec.addEventListener('click', () => { // [v6.11] ë©”ëª¨ ë™ì¼
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_fennec');
                galleryDetailTitle.innerText = "í•™ìƒíšŒì¥ í˜ë„¥";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/e61c85ae-b502-40bc-b2c6-45858eeef0db.png" alt="í˜ë„¥">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ì•„, í˜ë„¥ í•™ìƒíšŒì¥! ì •ë§ ë©‹ìˆì—ˆì§€...<br>
                        ì €ë ‡ê²Œ ì¡°ê·¸ë§Œë°ë„ í•­ìƒ ë‚  ì˜ ì±™ê²¨ì¤¬ì–´. (ë™ê²½...)
                    </div>`;
            });
            
            galleryItemSexy.addEventListener('click', () => {
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_sexy');
                galleryDetailTitle.innerText = "ë¹„ë°€â™¥";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/30a93d41-851b-411c-967f-a68075a5e7a1.jpeg" alt="ì„¹ì‹œ">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        (ë©”ëª¨ ì—†ìŒ)
                    </div>`;
            });

            galleryItemLapinFishing.addEventListener('click', () => { 
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_lapin_fishing');
                galleryDetailTitle.innerText = "ë¼í•€ ë‚šì‹œ";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/680467da-a19c-4dff-a01d-c7b54bc52c4e.jpeg" alt="ë¼í•€ ë‚šì‹œ">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ì´ ë„ˆêµ¬ë¦¬... ê°‘ìê¸° ì´ê±¸ ë‚˜í•œí…Œ ì™œ ë³´ë‚¸ ê±°ì§€?<br>
                        ë¶„ëª…íˆ ì¼ ì•ˆ í•˜ê³  ë†ë•¡ì´ í”¼ìš°ëŠ” ì¤‘ì¼ ê±°ì•¼!
                    </div>`;
            });

            galleryItemMirageSelca.addEventListener('click', () => { 
                appGallery.style.display = 'none';
                openApp(appGalleryDetail, 'trigger_gallery_mirage_selca');
                galleryDetailTitle.innerText = "ì§€ì›Œì§€ì§€ ì•ŠëŠ” ì‚¬ì§„";
                galleryDetailContent.innerHTML = `
                    <img src="https://d394jeh9729epj.cloudfront.net/8EgrdR7PfMI-KKKOVUNQUVI5/3fe4dfe7-544a-410e-a078-b452c68272c2.jpeg" alt="ë¯¸ë¼ì¥¬ ì…€ì¹´">
                    <div class="image-memo">
                        <strong>í˜ë¡œì˜ ë©”ëª¨:</strong>
                        ì§€ì›Œë„ ì§€ì›Œë„ ë‹¤ì‹œ ìƒê¸´ë‹¤.<br>
                        ëŒ€ì²´ ì–´ë–»ê²Œ... ë‚´, ë‚´ ì¹¨ëŒ€ì—...?!?
                    </div>`;
            });

            // --- 3. ë©”ì‹ ì € ì•± ë¡œì§ (v6.8ê³¼ ë™ì¼) ---
            const iconMessenger = document.getElementById('icon-messenger'); 
            const appMessenger = document.getElementById('app-messenger');
            const closeMessenger = document.getElementById('close-messenger');
            const appMessengerChat = document.getElementById('app-messenger-chat');
            const closeMessengerChat = document.getElementById('close-messenger-chat');
            const messengerChatTitle = document.getElementById('messenger-chat-title'); 
            const messengerChatContent = document.getElementById('messenger-chat-content'); 
            const messengerItemLapin = document.getElementById('messenger-item-lapin');
            const messengerItemTeam = document.getElementById('messenger-item-team'); 
            const messengerItemMirage = document.getElementById('messenger-item-mirage');

            iconMessenger.addEventListener('click', (e) => { 
                e.stopPropagation(); 
                openApp(appMessenger, 'trigger_messenger_open');
            });
            closeMessenger.addEventListener('click', () => {
                closeApp(appMessenger);
                history.back();
            });
            
            closeMessengerChat.addEventListener('click', () => {
                history.back();
            });

            messengerItemLapin.addEventListener('click', () => {
                appMessenger.style.display = 'none';
                openApp(appMessengerChat, 'trigger_lapin_chat');
                messengerChatTitle.innerText = "ì •ë³´ì›_ë¼í•€";
                messengerChatContent.innerHTML = `
                    <div class="chat-bubble lapin"><b>ë¼í•€:</b> ê·¸ë˜ì„œ, ìš©ê±´ì€?</div>
                    <div class="chat-bubble pherro"><b>í˜ë¡œ:</b> ì•¼! ì •ë³´ ë‚´ë†”! ë‹¹ì¥!</div>
                    <div class="chat-bubble lapin"><b>ë¼í•€:</b> ê·€ì°®ì•„...</div>
                    <div class="chat-bubble pherro"><b>í˜ë¡œ:</b> ì´ ë„ˆêµ¬ë¦¬ê°€!!</div>`;
            });

            messengerItemTeam.addEventListener('click', () => {
                appMessenger.style.display = 'none';
                openApp(appMessengerChat, 'trigger_team_chat');
                messengerChatTitle.innerText = "ë¯¸ë¼ì¥¬ ì²´í¬ ì‘ì „ë°˜ (3)";
                messengerChatContent.innerHTML = `
                    <div class="chat-bubble pherro"><b>í˜ë¡œ:</b> ë‹¤ë“¤ ë³µì°½í•´! ì´ë²ˆì—” ë¬´ì¡°ê±´ ì¡ëŠ”ë‹¤!</div>
                    <div class="chat-bubble"><b>ê²½ì°° 1:</b> ë„µ!</div>
                    <div class="chat-bubble"><b>ê²½ì°° 2:</b> (ì½ìŒ)</div>
                    <div class="chat-bubble pherro"><b>í˜ë¡œ:</b> 2íŒ€!! ëŒ€ë‹µ ì•ˆ í•´?!?</div>`;
            });
            
            messengerItemMirage.addEventListener('click', () => {
                appMessenger.style.display = 'none';
                openApp(appMessengerChat, 'trigger_mirage_chat');
                messengerChatTitle.innerText = "???";
                messengerChatContent.innerHTML = `
                    <div class="chat-bubble lapin"><b>???:</b> ì•ˆë…•, ê°•ì•„ì§€ ëŒ€ì¥ë‹˜?</div>
                    <div class="chat-bubble lapin"><b>???:</b> ì–´ì œ ë„¤ ì¹¨ëŒ€, ê½¤ í‘¹ì‹ í•˜ë˜ë°? (V)</div>
                    <div class="chat-bubble lapin"><b>???:</b> ë‹µì¥ ì•ˆ í•´? ì„­ì„­í•˜ë„¤~</div>`;
            });

            // --- [v6.10] 'ì‘ì „ì‹œì‘' ì•± ë¡œì§ ì¶”ê°€ ---
            const iconStartOp = document.getElementById('icon-start-op');
            const appStartOp = document.getElementById('app-start-op');
            const closeStartOp = document.getElementById('close-start-op');

            iconStartOp.addEventListener('click', (e) => {
                e.stopPropagation();
                openApp(appStartOp, 'trigger_start_op');
            });
            closeStartOp.addEventListener('click', () => {
                closeApp(appStartOp);
                history.back();
            });


            // --- í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë°˜ì‘ ì‹¤í–‰ ---
            if (isFirstVisit) {
                pherroReacts('trigger_first_visit');
                isFirstVisit = false;
            }
        });

    </script>
    </body>
    </html>
